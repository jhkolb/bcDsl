contract Auction {
    data {
      Seller: Identity
      HighestBidder: Identity
      HighestBid: Int
      AuctionStart: Timestamp
      Duration: Timespan
      Balances: Mapping[Identity, Int]
    }

    initialize: ->(duration: Timespan) open {
        Seller = sender
        HighestBid = 0
        AuctionStart = now
        Duration = duration
    }

    submitBid: open ->(bid: Int) open
    requires [ bid > HighestBid ] {
        Balances[HighestBidder] = Balances[HighestBidder] + HighestBid
        HighestBidder = sender
        HighestBid = bid
    }

    withdraw: open -> open requires [ Balances[sender] > 0 ] {
        send Balances[sender] to sender
        Balances[sender] = 0
    }

    auto closeAuction: open -> closed requires [ now - AuctionStart >= Duration ]
}

properties {
    [](contractBalance >= 0)
    [](<>(closed))
}